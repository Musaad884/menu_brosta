<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù…Ø·Ø¹Ù… Ø¨Ø±ÙˆØ³ØªØ§</title>
  <!-- â†“â†“â†“ (Ø¬Ø¯ÙŠØ¯) Ø³ÙƒØ±Ø¨Øª ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… ÙˆÙŠØ¨-Ø£Ø¨ â†“â†“â†“ -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <!-- â†‘â†‘â†‘ Ù„Ø§ ØªØ­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± â†‘â†‘â†‘ -->
  <style>
    body {
      font-family: Tahoma, sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 0;
      color: #333;
    }
    header {
      background: #fff;
      padding: 1rem;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      position: relative;
    }
    .checkout-global {
      position: sticky;
      top: 0;
      z-index: 10;
      background: #f9f9f9;
      text-align: center;
      padding: 0.5rem;
    }
    .checkout-global button {
      background: #4CAF50;
      color: #fff;
      padding: 0.8rem 1.2rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
    }
    .menu {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      padding: 1rem;
    }
    .item {
      background: #fff;
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .item img {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: 12px;
      margin-bottom: 0.5rem;
    }
    .item h3 {
      font-size: 1.1rem;
      margin: 0.5rem 0;
    }
    .item p {
      font-size: 0.9rem;
      margin: 0.3rem 0;
    }
    .item .actions {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    .item button {
      padding: 0.6rem 0.8rem;
      background: #4CAF50;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
    }
    .item .qty-btn {
      background: #2196F3;
      padding: 0.4rem 0.7rem;
      font-size: 1.2rem;
      font-weight: bold;
    }
    .cart {
      position: fixed;
      top: 0;
      right: -400px;
      width: 350px;
      height: 100%;
      background: #fff;
      box-shadow: -2px 0 6px rgba(0,0,0,0.2);
      padding: 1rem;
      transition: right 0.3s ease;
      display: flex;
      flex-direction: column;
    }
    .cart.open {
      right: 0;
    }
    .cart h2 {
      margin-top: 0;
    }
    .cart-items {
      flex: 1;
      overflow-y: auto;
    }
    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    .cart-item button {
      background: #f44336;
      border: none;
      color: #fff;
      padding: 0.3rem 0.6rem;
      border-radius: 6px;
      cursor: pointer;
    }
    .cart-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #2196F3;
      color: #fff;
      padding: 1rem;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body>
  <header>Ù…Ù†ÙŠÙˆ Ù…Ø·Ø¹Ù… Ø¨Ø±ÙˆØ³ØªØ§</header>
  
  <!-- Ø²Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ØªØ­Øª Ø§Ù„Ù‡ÙŠØ¯Ø± -->
  <div class="checkout-global">
    <button onclick="checkout()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
  </div>

  <div class="menu" id="menu"></div>
  <div class="cart" id="cart">
    <h2>Ø§Ù„Ø³Ù„Ø©</h2>
    <div class="cart-items" id="cart-items"></div>
  </div>
  <div class="cart-toggle" onclick="toggleCart()">ğŸ›’</div>

  <script>
    // (Ø¬Ø¯ÙŠØ¯) ØªÙ‡ÙŠØ¦Ø© Ø®ÙÙŠÙØ© Ù„ÙˆÙŠØ¨-Ø£Ø¨ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
    const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;
    if (tg) { try { tg.ready(); tg.expand(); } catch(_){} }

    const menuData = [
      {id:1, category:'Sandwiches / Ø§Ù„Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª', name:'Smoked Chicken Burger / Ø¨Ø±Ø¬Ø± Ù…Ø¯Ø®Ù† Ø¯Ø¬Ø§Ø¬', description:'Crispy chicken burger with lettuce & sauce / Ø¨Ø±Ø¬Ø± Ø¯Ø¬Ø§Ø¬ ÙƒØ±Ø³Ø¨ÙŠ Ù…Ø¹ Ø§Ù„Ø®Ø³ ÙˆØ§Ù„ØµÙˆØµ', price:'17-25', image:''},
      {id:2, category:'Sandwiches / Ø§Ù„Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª', name:'Smoked Chicken Burger Spicy / Ø¨Ø±Ø¬Ø± Ù…Ø¯Ø®Ù† Ø¯Ø¬Ø§Ø¬ Ø­Ø§Ø±', description:'Crispy spicy chicken burger with lettuce & sauce / Ø¨Ø±Ø¬Ø± Ø¯Ø¬Ø§Ø¬ ÙƒØ±Ø³Ø¨ÙŠ Ø­Ø§Ø± Ù…Ø¹ Ø§Ù„Ø®Ø³ ÙˆØ§Ù„ØµÙˆØµ', price:'17-25', image:''},
      {id:3, category:'Meals / Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', name:'Smoked Broasted / Ø¨Ø±ÙˆØ³ØªØ¯ Ù…Ø¯Ø®Ù†', description:'4 pcs smoked broasted chicken with fries & sauce / Ù¤ Ù‚Ø·Ø¹ Ø¯Ø¬Ø§Ø¬ Ø¨Ø±ÙˆØ³ØªØ¯ Ù…Ø¯Ø®Ù† Ù…Ø¹ Ø§Ù„Ø¨Ø·Ø§Ø·Ø³ ÙˆØ§Ù„ØµÙˆØµ', price:'29', image:''},
      {id:4, category:'Meals / Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', name:'Spicy Smoked Broasted / Ø¨Ø±ÙˆØ³ØªØ¯ Ù…Ø¯Ø®Ù† Ø­Ø§Ø±', description:'4 pcs spicy smoked broasted chicken with fries & sauce / Ù¤ Ù‚Ø·Ø¹ Ø¯Ø¬Ø§Ø¬ Ø¨Ø±ÙˆØ³ØªØ¯ Ù…Ø¯Ø®Ù† Ø­Ø§Ø± Ù…Ø¹ Ø§Ù„Ø¨Ø·Ø§Ø·Ø³ ÙˆØ§Ù„ØµÙˆØµ', price:'29', image:''},
      {id:5, category:'Meals / Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', name:'Smoked Crispy / ÙƒØ±ÙŠØ³Ø¨ÙŠ Ù…Ø¯Ø®Ù†', description:'Smoked crispy chicken with fries & sauce / Ø¯Ø¬Ø§Ø¬ ÙƒØ±ÙŠØ³Ø¨ÙŠ Ù…Ø¯Ø®Ù† Ù…Ø¹ Ø§Ù„Ø¨Ø·Ø§Ø·Ø³ ÙˆØ§Ù„ØµÙˆØµ', price:'25', image:''},
      {id:6, category:'Meals / Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', name:'Spicy Smoked Crispy / ÙƒØ±ÙŠØ³Ø¨ÙŠ Ù…Ø¯Ø®Ù† Ø­Ø§Ø±', description:'Spicy smoked crispy chicken with fries & sauce / Ø¯Ø¬Ø§Ø¬ ÙƒØ±ÙŠØ³Ø¨ÙŠ Ù…Ø¯Ø®Ù† Ø­Ø§Ø± Ù…Ø¹ Ø§Ù„Ø¨Ø·Ø§Ø·Ø³ ÙˆØ§Ù„ØµÙˆØµ', price:'26', image:''},
      {id:7, category:'Meals / Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', name:'Smoked Crunchy / ÙƒØ±Ø§Ù†Ø´ÙŠ Ù…Ø¯Ø®Ù†', description:'Smoked crunchy chicken with fries & sauce / ØµØ¯ÙˆØ± Ø¯Ø¬Ø§Ø¬ Ù…Ø¯Ø®Ù†Ø© Ù…Ø¹ Ø§Ù„Ø¨Ø·Ø§Ø·Ø³ ÙˆØ§Ù„ØµÙˆØµ', price:'32', image:''},
      {id:8, category:'Meals / Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', name:'Smoked Crunchy Spicy / ÙƒØ±Ø§Ù†Ø´ÙŠ Ù…Ø¯Ø®Ù† Ø­Ø§Ø±', description:'Spicy smoked crunchy chicken with fries & sauce / ØµØ¯ÙˆØ± Ø¯Ø¬Ø§Ø¬ Ù…Ø¯Ø®Ù†Ø© Ø­Ø§Ø±Ø© Ù…Ø¹ Ø§Ù„Ø¨Ø·Ø§Ø·Ø³ ÙˆØ§Ù„ØµÙˆØµ', price:'31', image:''},
      {id:9, category:'Meals / Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', name:'Cheese Fries / Ø¨Ø·Ø§Ø·Ø³ Ø¨Ø§Ù„Ø¬Ø¨Ù†Ø©', description:'Fries topped with cheese / Ø¨Ø·Ø§Ø·Ø³ Ù…Ø¹ Ø¬Ø¨Ù†Ø©', price:'14', image:''},
      {id:10, category:'Meals / Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', name:'Smoked Chicken Fries / Ø³Ù…ÙˆÙƒØ¯ ØªØ´ÙƒÙ† ÙØ±Ø§ÙŠØ²', description:'Fries topped with smoked chicken / Ø¨Ø·Ø§Ø·Ø³ Ù…Ø¹ Ø¯Ø¬Ø§Ø¬ Ù…Ø¯Ø®Ù†', price:'25', image:''},
      {id:11, category:'Meals / Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', name:'Onion Rings / Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø¨ØµÙ„', description:'Fried onion rings / Ø­Ù„Ù‚Ø§Øª Ø¨ØµÙ„ Ù…Ù‚Ù„ÙŠØ©', price:'9', image:''},
      {id:12, category:'Meals / Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', name:'French Fries / Ø¨Ø·Ø§Ø·Ø³ Ù…Ù‚Ù„ÙŠØ©', description:'Regular fries / Ø¨Ø·Ø§Ø·Ø³ Ø¹Ø§Ø¯ÙŠØ©', price:'8', image:''},
      {id:13, category:'Meals / Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', name:'Curly Fries / ÙƒÙŠØ±Ù„ÙŠ ÙØ±Ø§ÙŠØ²', description:'Curly fries / Ø¨Ø·Ø§Ø·Ø³ Ø­Ù„Ø²ÙˆÙ†ÙŠØ©', price:'9', image:''},
      {id:14, category:'Sauces / Ø§Ù„ØµÙˆØµØ§Øª', name:'Spicy Sauce / ØµÙˆØµ Ø­Ø§Ø±', description:'Spicy sauce / ØµÙˆØµ Ø­Ø§Ø±', price:'1', image:''},
      {id:15, category:'Sauces / Ø§Ù„ØµÙˆØµØ§Øª', name:'Garlic Sauce / ØµÙˆØµ Ø«ÙˆÙ…', description:'Garlic Sauce / ØµÙˆØµ Ø«ÙˆÙ…', price:'1', image:''},
      {id:16, category:'Sauces / Ø§Ù„ØµÙˆØµØ§Øª', name:'Cheese Sauce / ØµÙˆØµ Ø¬Ø¨Ù†Ø©', description:'Cheese Sauce / ØµÙˆØµ Ø¬Ø¨Ù†Ø©', price:'3', image:''},
      {id:17, category:'Drinks / Ù…Ø´Ø±ÙˆØ¨Ø§Øª', name:'Fanta / ÙØ§Ù†ØªØ§', description:'Soft drink / Ù…Ø´Ø±ÙˆØ¨ ØºØ§Ø²ÙŠ', price:'4', image:''},
      {id:18, category:'Drinks / Ù…Ø´Ø±ÙˆØ¨Ø§Øª', name:'Sprite / Ø³Ø¨Ø±Ø§ÙŠØª', description:'Soft drink / Ù…Ø´Ø±ÙˆØ¨ ØºØ§Ø²ÙŠ', price:'4', image:''},
      {id:19, category:'Drinks / Ù…Ø´Ø±ÙˆØ¨Ø§Øª', name:'Cola / ÙƒÙˆÙ„Ø§', description:'Soft drink / Ù…Ø´Ø±ÙˆØ¨ ØºØ§Ø²ÙŠ', price:'4', image:''}
    ];

    const menuContainer = document.getElementById("menu");
    const cartContainer = document.getElementById("cart-items");
    let cart = [];
    let checkoutStep = 0; // Ù„Ù„ØªØ­ÙƒÙ… Ø¨Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¥Ø±Ø³Ø§Ù„

    function renderMenu(){
      menuContainer.innerHTML = "";
      menuData.forEach(item => {
        const div = document.createElement("div");
        div.className = "item";
        const inCart = cart.find(c => c.id === item.id);

        div.innerHTML = `
          <img src="${item.image || 'https://via.placeholder.com/300x150'}" alt="${item.name}" />
          <h3>${item.name}</h3>
          <p>${item.description}</p>
          <p><strong>${item.price} Ø±ÙŠØ§Ù„</strong></p>
          <div class="actions" id="actions-${item.id}">
            ${inCart 
              ? `
                <button class="qty-btn" onclick="changeQty(${item.id}, -1)">-</button>
                <span>${inCart.qty}</span>
                <button class="qty-btn" onclick="changeQty(${item.id}, 1)">+</button>
              `
              : `<button onclick="addToCart(${item.id})">Ø§Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>`
            }
          </div>
        `;
        menuContainer.appendChild(div);
      });
    }

    function addToCart(id){
      const item = menuData.find(m => m.id === id);
      const found = cart.find(c => c.id === id);
      if(found){
        found.qty++;
      } else {
        cart.push({...item, qty:1});
      }
      renderMenu();
      renderCart();
    }

    function changeQty(id, delta){
      const found = cart.find(c => c.id === id);
      if(found){
        found.qty += delta;
        if(found.qty <= 0){
          cart = cart.filter(c => c.id !== id);
        }
      }
      renderMenu();
      renderCart();
    }

    function removeFromCart(id){
      cart = cart.filter(c => c.id !== id);
      renderMenu();
      renderCart();
    }

    function renderCart(){
      cartContainer.innerHTML = '';
      cart.forEach(c => {
        const div = document.createElement("div");
        div.className = "cart-item";
        div.innerHTML = `
          <span>${c.name} x${c.qty}</span>
          <button onclick="removeFromCart(${c.id})">Ø­Ø°Ù</button>
        `;
        cartContainer.appendChild(div);
      });

      // Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
      const total = cart.reduce((sum,c) => sum + (parseFloat(c.price) || 0) * c.qty, 0);
      const totalDiv = document.createElement("div");
      totalDiv.style.marginTop = "1rem";
      totalDiv.style.fontWeight = "bold";
      totalDiv.innerText = "Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: " + total + " Ø±ÙŠØ§Ù„";
      cartContainer.appendChild(totalDiv);
    }

    function toggleCart(){
      document.getElementById("cart").classList.toggle("open");
    }

    async function checkout(){
      if(cart.length === 0){
        alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©!");
        return;
      }

      if(checkoutStep === 0){
        toggleCart(); // ÙŠÙØªØ­ Ø§Ù„Ø³Ù„Ø© Ø£ÙˆÙ„ Ù…Ø±Ø©
        checkoutStep = 1;
        return;
      }

      const payload = {
        items: cart,
        total: cart.reduce((sum,c) => sum + (parseFloat(c.price) || 0) * c.qty, 0),
        time: new Date().toISOString()
      };

      // ======= (ØªØ¹Ø¯ÙŠÙ„Ùƒ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨) Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø¨Ø¯Ù„ Ø§Ù„ÙˆÙŠØ¨Ù‡ÙˆÙƒ =======
      try {
        if (tg && tg.sendData) {
          tg.sendData(JSON.stringify(payload)); // ÙŠØ±Ø³Ù„Ù‡Ø§ Ù„Ù„Ø¨ÙˆØª
          try { tg.close(); } catch(_){}        // ÙŠØºÙ„Ù‚ Ø§Ù„ÙˆÙŠØ¨-Ø£Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
          // Ù†ÙØ¶ÙŠ Ø§Ù„Ø³Ù„Ø© Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
          cart = [];
          renderMenu();
          renderCart();
          checkoutStep = 0;
          alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨");
        } else {
          alert("âš ï¸ Ø§ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ù…Ù† Ø¯Ø§Ø®Ù„ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… (WebApp)");
        }
      } catch (err) {
        alert("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: " + err.message);
      }
      // ========================================================================
    }

    renderMenu();
  </script>
</body>
</html>
